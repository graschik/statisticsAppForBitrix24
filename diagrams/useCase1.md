# Варианты использования
---

![UseCase](https://github.com/kirillEvstrat/statisticsAppForBitrix24/blob/master/diagrams/Usecase.png)

# Содержание
1 [Актёры](#1) <br>
2 [Варианты использования](#2) <br>
  2.1 [Авторизоваться](#2.1) <br>
  2.2 [Загрузить статистику](#2.2) <br>
  2.3 [Просмотреть общую статистику ](#2.3) <br>
  2.4 [Просмотреть статистику по отделу компании](#2.4) <br>
  2.5 [Просмотреть статистику за определенный месяц](#2.5) <br>
  2.6 [Просмотреть статистику сотрудника](#2.6) <br>
  2.7 [Вывести план продаж](#2.7) <br>
  2.8 [Изменить план продаж](#2.8) <br>

<a name="1"/>

# 1 Актёры

| Актёр | Описание |
|:--|:--|
| Анонимный пользователь | Пользователь, не зарегистрированный в системе |
| Зарегистрированный пользователь | Пользователь использующий систему войдя в свой аккаунт  |
| Администратор | Пользователь, вошедший в аккаунт с правами администратора  |

<a name="2"/>

# 2 Варианты использования

<a name="2.1"/>

## 2.1 Авторизоваться

**Описание.** Вариант использования "Авторизоваться" позволяет пользователю получить доступ к приложению.

**Основной поток.**
1. При попытке получить доступ к встроенному приложению по прямой ссылке неавторизованный пользователь будут переброшен в окно авторизации битрикс24.
2. Пользователь заполняет необходимые для авторизации поля.
3. Пользователь подтверждает введенные данные, нажав кнопку "Войти".
Если некоторые поля не заполнены, то выполняется альтернативный поток A1.
4. Данные для входа отправляются на сервер.
5. Приложение принимает результат операции. Если авторизация завершилась неудачно, то выполняется альтернативный поток A2.
6.Битрикс24 перенаправляет на главную страницу встроенного приложения;
7. Вариант использования завершается;

**Альтернативный поток А1.**
1. Приложение выводит сообщение о том, что некоторые поля не заполнены.
2. Возврат к п.2 основного потока;

**Альтернативный поток А2.**
1. Приложение выводит сообщение о неудачной попытке авторизации.
2. Возврат к п.1 основного потока;

<a name="2.2"/>

## 2.3 Загрузить статистику

**Описание.** Вариант использования "Загрузить статистику" позволяет пользователю одним нажатием кнопки выгрузить всю нужную статистику из CRM  **Основной поток.**
1. Пользователь видит сообщение  о необходимости предварительной выгрузки статистики.
2. Пользователь нажимает кнопку «загрузить статистику».
3. Приложение возвращает с сервера выгруженные, рассчитанные и обработанные для дальнейшего использования данные.
4. Вариант использования завершается.


<a name="2.3"/>

## 2.3 Просмотреть общую статистику.

**Описание.** Вариант использования " Просмотреть общую статистику " позволяет пользователю просмотреть всю выгруженную статистику в удобных графиках и таблицах.
**Основной поток.**
1. Приложение обрабатывает данные полученные с сервера для работы на стороне браузера.
2. Сортирует данные для построения каждой таблицы и диаграммы.
3. Обрабатывает их для рендеринга диаграмм.
4.  Выводит диаграммы и таблицы на экран .
5. Вариант использования завершается.


<a name="2.4"/>

## 2.4 Сортировка по отделу компании

**Описание.** Вариант использования " Сортировка по отделу компании " позволяет пользователю просмотреть статистику по конкретному отделу .
**Основной поток.**
1. Приложение подгружает структуру разделение компании на отделы из битрикс24.
2. Пользователь выбирает интересующий его отдел.
3. Приложение отсортировывает из ранее выгруженной статистики те данные, которые относятся к пользователям, выбранного отдела.
4. Выполняются пункты 2-4 варианты использования «Просмотреть общую статистику» .
5. Вариант использования завершается.

<a name="2.5"/>

## 2.5 Просмотреть статистику за месяц.

**Описание. ** Вариант использования" Просмотреть статистику за месяц" позволяет пользователю проанализировать статистику за определенный период времени .
**Основной поток.**
1. Пользователь выбирает месяц в форме с выпадающим календарем.
2. приложение отсортировывает статистику за выбранный  месяц.
3. Выполняются пункты 2-4 варианты использования «Просмотреть общую статистику» .
4. Вариант использования завершается.
<a name="2.6"/>

## 2.6 Просмотреть план продаж.

**Описание.** Вариант использования " Просмотреть план продаж " позволяет администратору увидеть план продаж компании.
**Основной поток.**
1.Пользователь нажимает кнопку «План продаж».
2. Проверка прав пользователя .
3. Если у пользователя нет прав администратора – альтернативный поток  A3. 
4. Если права есть – выгрузка данных по плану продаж с сервера.
5. Вывод данных списком в браузере
6. Вариант использования завершается.

**Альтернативный поток А3.**
1. Приложение выводит сообщение об отсутствии прав администратора и перенаправляет пользователя на главную страницу приложения.
2. Вариант использования завершается;
<a name="2.7"/>

## 2.7 Изменить план продаж.

**Описание.** Вариант использования " Изменить план продаж." позволяет администартору изменить план конкретного сотрудника или всей компании.
**Основной поток.**
1.Пользователь нажимает кнопку «Изменить План продаж».
2. Проверка прав пользователя .
3. Если у пользователя нет прав администратора – альтернативный поток  A3. 
4. Если права есть – выгрузка данных по плану продаж с сервера.
5. Пользователь изменяет предполагаемый план на текущий месяц
6. Нажимает кнопку «сохранить»
7. Новые данные загружаются на сервер.
8. Вариант использования завершается.

**Альтернативный поток А3.**
1. Приложение выводит сообщение об отсутствии прав администратора и перенаправляет пользователя на главную страницу приложения.
2. Вариант использования завершается;
